# Activit√© 0 : Mise en place de l‚Äôinfrastructure r√©seau des agences de l‚Äôentreprise CUB

![](../../media/logo-cub.png)

## Pr√©requis

![](../../media/schema-logique-cub.png)

*Ducumentation en ligne : [https://cubdocumentation.sioplc.fr](https://cubdocumentation.sioplc.fr)*
<br>

## Adressage 

| Puissance de 2 | Valeur |
|:---------------:|:------:|
| 2‚Å∞ | 1 |
| 2¬π | 2 |
| 2¬≤ | 4 |
| 2¬≥ | 8 |
| 2‚Å¥ | 16 |
| 2‚Åµ | 32 |
| 2‚Å∂ | 64 |
| <span style="background-color:#aee7ff; padding:2px 4px; border-radius:3px;">**2‚Å∑**</span> | <span style="background-color:#aee7ff; padding:2px 4px; border-radius:3px;">**128**</span> |

**Adresse r√©seau : 192.168.6.0/24**

<br>

| **Service** | **Nombre d‚Äôh√¥tes** | **Adresse r√©seau** | **Masque de sous-r√©seau** | **Adresse de diffusion** | **Description VLAN** |
|--------------|--------------------:|--------------------|----------------------------|---------------------------|----------------------|
| Production | 120 | 192.168.6.0 | <span style="background-color:#b7fbb7;">255.255.255.128</span> | 192.168.6.127 | VLAN 56 |
| Client 1 | 32 | 192.168.6.128 | 255.255.255.192 | 192.168.6.191 | VLAN 10 |
| Administration syst√®mes et r√©seaux | 6 | 192.168.6.192 | 255.255.255.240 | 192.168.6.207 | VLAN 20 |

<br>

**N¬∞1 sous-r√©seau Production = 126 h√¥tes ‚Üí** <span style="background-color:#aee7ff; padding:2px 4px; border-radius:3px;">**2‚Å∑**</span> **‚Üí <span style="background-color:#b7fbb7;">/25**</span>

**Production = 192.168.6.0/24 ‚Üí 255.255.255.128 ‚Üí** <span style="background-color:#aee7ff; padding:2px 4px; border-radius:3px;">**x.x.x.1000 0000**</span>

**Diffusion :** `1100 0000 . 1010 1000 . 0000 0110 . 0111 1111`  
‚û°Ô∏è 192.168.6.**127**

___

## Sch√©ma logique ‚Äì Agence Frankfur

![](../../media/bloc2/ExploitationServ/Activite0-1.png)

___
## Packet tracert - Agence Frankfurt
<br>

![](../../media/packet-tracert-v1.jpg)
<br>

<div style="text-align:center; margin-top:20px;">
  <a href="https://drive.google.com/file/d/1L7Gp52YpPjjRhFdp9gp4L1sGORqAoCEK/view?usp=share_link" 
     style="display:inline-block;
            background:#e7e7e9;
            color:#0096FF;
            padding:11px 25px;
            border-radius:10px;
            text-decoration:none;
            font-weight:50;
            box-shadow:0 0 12px rgba(0,0,0,0.5);
            transition:all 0.3s ease;"
     onmouseover="this.style.background='#dcdce0'; this.style.color='#003d80';"
     onmouseout="this.style.background='#e7e7e9'; this.style.color='#0096FF';">
     üîó Cliquer pour t√©l√©cherger le paket tracert
  </a>
</div>
<br>

___

## Plan de c√¢blage 

![](../../media/bloc2/ExploitationServ/Activite0-2.png)

___

**FW**

| Destination      | Masque | Passerelle       | Interface       | Type |
|-----------------|--------|-----------------|----------------|------|
| 192.36.253.0    | /24    | 192.36.253.60   | 192.36.253.60  | C    |
| 192.36.6.0      | /24    | 192.36.6.254    | 192.36.6.254   | C    |
| 192.168.66.248  | /28    | 192.168.66.254  | 192.168.66.254 | C    |
| 192.168.6.0     | /24    | 192.168.66.253  | 192.168.66.254 | S    |
| 0.0.0.0         | /0     | 192.36.253.254  | 192.36.253.60  | S    |

**LAYER 3**

| Destination      | Masque | Passerelle       | Interface       | Type |
|-----------------|--------|-----------------|----------------|------|
| 192.168.6.0     | /25    | 192.168.6.126   | 192.168.6.126  | C    |
| 192.168.66.248  | /28    | 192.168.66.253  | 192.168.66.253 | C    |
| 192.168.6.128   | /26    | 192.168.6.190   | 192.168.6.190  | C    |
| 192.168.6.192   | /28    | 192.168.66.206  | 192.168.66.206 | S    |
| 0.0.0.0         | /0     | 192.168.66.254  | 192.168.66.253 | S    |

**Routage NAT**

<table>
  <tr>
    <th colspan="4">Avant translation</th>
    <th colspan="4">Apr√®s translation</th>
  </tr>
  <tr>
    <th>Ip source</th>
    <th>Port Src</th>
    <th>IP dst</th>
    <th>Port dst</th>
    <th>Ip source</th>
    <th>Port Src</th>
    <th>IP dst</th>
    <th>Port dst</th>
  </tr>
  <tr>
    <td>192.168.6.0 /24</td>
    <td>*</td>
    <td>*</td>
    <td>*</td>
    <td>192.36.253.60 /24</td>
    <td>*</td>
    <td>*</td>
    <td>*</td>
  </tr>
</table>

___

## 1. Fichier de configuration des diff√©rents √©quipements 


<div style="margin-top:20px;">
  <a href="https://drive.google.com/file/d/1bF75ljARePUwne40Eg3HO-nEavDCPnye/view?usp=share_link" 
     style="display:inline-block;
            background:#e7e7e9;
            color:#0096FF;
            padding:11px 25px;
            border-radius:10px;
            text-decoration:none;
            font-weight:50;
            box-shadow:0 0 12px rgba(0,0,0,0.5);
            transition:all 0.3s ease;"
     onmouseover="this.style.background='#dcdce0'; this.style.color='#003d80';"
     onmouseout="this.style.background='#e7e7e9'; this.style.color='#0096FF';">
     üîó Cliquer pour t√©l√©charger la configuration du SW LAYER 2 
  </a>
</div>

<div style="margin-top:20px;">
  <a href="https://drive.google.com/file/d/1ZiBFeQQwt0jd8EZbdG5kENWhuKL00H2E/view?usp=share_link" 
     style="display:inline-block;
            background:#e7e7e9;
            color:#0096FF;
            padding:11px 25px;
            border-radius:10px;
            text-decoration:none;
            font-weight:50;
            box-shadow:0 0 12px rgba(0,0,0,0.5);
            transition:all 0.3s ease;"
     onmouseover="this.style.background='#dcdce0'; this.style.color='#003d80';"
     onmouseout="this.style.background='#e7e7e9'; this.style.color='#0096FF';">
     üîó Cliquer pour t√©l√©charger la configuration du SW LAYER 3
  </a>
</div>

<div style="margin-top:20px;">
  <a href="https://drive.google.com/file/d/1F8QaNltIlI1-h1X0EihRWQ0JFQCPO-Ap/view?usp=share_link" 
     style="display:inline-block;
            background:#e7e7e9;
            color:#0096FF;
            padding:11px 25px;
            border-radius:10px;
            text-decoration:none;
            font-weight:50;
            box-shadow:0 0 12px rgba(0,0,0,0.5);
            transition:all 0.3s ease;"
     onmouseover="this.style.background='#dcdce0'; this.style.color='#003d80';"
     onmouseout="this.style.background='#e7e7e9'; this.style.color='#0096FF';">
     üîó Cliquer pour t√©l√©charger la configuration du SW DMZ 
  </a>
</div>


<div style="margin-top:20px;">
  <a href="https://drive.google.com/file/d/1F8QaNltIlI1-h1X0EihRWQ0JFQCPO-Ap/view?usp=share_link" 
     style="display:inline-block;
            background:#e7e7e9;
            color:#0096FF;
            padding:11px 25px;
            border-radius:10px;
            text-decoration:none;
            font-weight:50;
            box-shadow:0 0 12px rgba(0,0,0,0.5);
            transition:all 0.3s ease;"
     onmouseover="this.style.background='#dcdce0'; this.style.color='#003d80';"
     onmouseout="this.style.background='#e7e7e9'; this.style.color='#0096FF';">
     üîó Cliquer pour t√©l√©charger la configuration du pare feu agence 
  </a>
</div>

<div style="margin-top:20px;">
  <a href="https://drive.google.com/file/d/1rWXNRImZjDRd-_5M8QgQKYOFJy9BefWo/view?usp=share_link" 
     style="display:inline-block;
            background:#e7e7e9;
            color:#0096FF;
            padding:11px 25px;
            border-radius:10px;
            text-decoration:none;
            font-weight:50;
            box-shadow:0 0 12px rgba(0,0,0,0.5);
            transition:all 0.3s ease;"
     onmouseover="this.style.background='#dcdce0'; this.style.color='#003d80';"
     onmouseout="this.style.background='#e7e7e9'; this.style.color='#0096FF';">
     üîó Cliquer pour t√©l√©charger la configuration du pare feu si√®ge
  </a>
</div>

## 2. Configuration du routage statique 

**Router(config)#**
```bash
 ip routing
```

**Router(config)#** *`ip route destination masque passerelle`*

**Exemple :**
```bash
ip route 10.0.0.0 255.0.0.0 172.16.0.253
```

Pour afficher les routes cr√©er : 
```bash
show ip route
```

## 3. Configuration du routage NAT

Avant de commencer, activer `IP routing`

**Router(config)#**
```bash
ip routing
```

### 3.1 D√©signer les interfaces Inside et Outside (Interne et Externe)

**Router(config)#**

```bash
interface g0/0
ip nat inside
no shutdown
```

**Router(config)#**
```bash
interface g0/1
ip nat outside
no shutdown 
```

### 3.2 D√©finir les adresses locales soumises au NAT dans l'optique de les masquer pour qu'elles puissent avoir acc√®s √† l'ext√©rieur et que l'ext√©rieur ne voit que l'adresse du routeur.

**Router(config)#** : *`access-list access-list number permit source ip wildcard_mask`*

Le terme ***wildcard_mask*** d√©signe un masque invers√©, pour un masque de sous-r√©seau de 255.255.255.0 le ***wildcard mask*** sera 0.0.0.255.

**Exemple :**
```bash
access-list 1 permit 10.0.0.0 0.255.255.255 
```

### 3.3 Mise en place de la translation LAN vers IP publique

**Router (config)#** *`ip nat inside source list numero-acl interface int-publique overload`*

**Exemple :**
```bash
ip nat inside source list 1 interface GigabitEthernet 0/1 overload
```

## 4. Configuration du pare-feu Stormshield 
*Se r√©f√©rer √† la documentation suivante : https://cubdocumentation.sioplc.fr*

![](../../media/bloc2/ExploitationServ/Activite0-3.png)

**Premier encadr√© :** Ceci est la route par d√©faut calcul√©e auparavant sur la table de routage.


**Deuxi√®me encadr√© :** Ceci est l‚Äôautre route statique calcul√©e auparavant sur la table de routage.
